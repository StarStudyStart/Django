<html>
<head>
  <title>7、重定向</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600718 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="593"/>
<h1>7、重定向</h1>

<div>
<span><div><div><div><div><span style="font-size: 12pt;">      <span style="font-size: 12pt; font-family: 华文仿宋;"> 与 Unix 主题“任何东西都是一个文件”保持一致，程序，比方说 ls，实际上把他们的运行</span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-family: 华文仿宋;">结果输送到一个叫做标准输出的特殊文件（经常用 stdout 表示），而它们的状态信息则送到另</span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-family: 华文仿宋;">一个叫做标准错误的文件（stderr）。默认情况下，标准输出和标准错误都连接到屏幕，而不是</span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-family: 华文仿宋;">保存到磁盘文件。除此之外，许多程序从一个叫做标准输入（stdin）的设备得到输入，默认情</span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-family: 华文仿宋;">况下，标准输入连接到键盘。</span></span></div><div><span style="font-size: 12pt;">标准输出默认是屏幕，标准输入默认是键盘</span></div><div><span style="font-size: 12pt;">1、重定向标准输出</span></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt;">       &quot;&gt;&quot;用于重定向标准 ，使用“&gt;”来重定向标准输出时，目标文件总被重写（重新覆盖）</span></font></div><div style="box-sizing: border-box; padding: 8px; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;">   &gt; ls-output.txt</span></div></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt;">        所以可以使用以上命令行</span><span style="font-size: 12pt; color: rgb(227, 0, 0);">删除一个文件的内容，或者创建一个空文件</span></font></div><div><span style="font-size: 12pt;">       </span> <span style="font-size: 12pt; color: rgb(227, 0, 0);">使用“&gt;&gt;”可以将重定向标准输出添加到文件内容之后</span></div><blockquote style="margin: 0px 0px 0px 40px; border: none; padding: 0px;"><div><span style="font-size: 12pt; color: rgb(227, 0, 0);">    <img src="7、重定向_files/ScreenClip.png" type="image/png" data-filename="ScreenClip.png" style="font-size: 12pt; color: rgb(227, 0, 0);"/></span></div></blockquote><div><br/></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt;">2、重定向标准错误</span></font></div><div><br/></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt;">    </span><span style="font-size: 12pt;"><span style="font-size: 12pt; font-family: 仿宋;">重定向标准错误缺乏专用的重定向操作符。重定向标准错误，我们必须参考它的文件描述</span></span></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-family: 仿宋;">符。一个程序可以在几个编号的文件流中的任一个上产生输出。然而我们必须把这些文件流</span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-family: 仿宋;">的前三个看作标准输入，输出和错误，shell 内部参考它们为文件描述符 0，1 和 2，各自地。</span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-family: 仿宋;">shell 提供了一种表示法来重定向文件，使用文件描述符。因为标准错误和文件描述符 2 一样，</span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-family: 仿宋;">我们用这种表示法来重定向标准错误：</span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-family: 仿宋;">    </span></span></div></div><div><img src="7、重定向_files/ScreenClip [1].png" type="image/png" data-filename="ScreenClip.png"/></div><div><span style="font-size: 12pt;">3、重定向标准输出和标准错误到同一文件</span></div><div><span style="font-size: 12pt;">    两种的方法：</span></div><div><span style="font-size: 12pt;">        ① （shell版本）</span></div><div style="box-sizing: border-box; padding: 8px; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;">            ls -l /bin/usr &gt; ls-output.txt  2&gt;&amp;1</span></div></div><div><span style="font-size: 12pt;">            首先重定向</span><span style="font-size: 12pt;">标准输出到<span style="font-size: 12pt;">ls-output.txt，然后将标准错误重定向到标准输出<span style="font-size: 12pt; color: rgb(227, 0, 0);">（顺序不能反）</span></span></span></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt;"><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(227, 0, 0);">       </span> <span style="font-size: 12pt;">② （bash版本）</span></span></span></font></div><div style="box-sizing: border-box; padding: 8px; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;">            ls -l /bin/usr &amp;&gt; ls-output.txt </span></div></div><div><span style="font-size: 9pt; line-height: 1.45;">                    </span><span style="font-size: 12pt; line-height: 1.45;">使用单单一个表示法 &amp;&gt; 来重定向标准输出和错误到文件 ls-</span><span style="font-size: 12pt; line-height: 1.45;">output.txt。</span></div><div><br/></div><div><span style="font-size: 12pt; line-height: 1.45;">4、处理不必要的输出 </span></div><div><span style="font-size: 12pt; line-height: 1.45;"> </span></div><div><span style="font-size: 12pt; line-height: 1.45;">     </span><span style="font-size: 12pt; font-family: 华文仿宋; line-height: 1.45;"> </span><span style="font-size: 12pt; font-family: 华文仿宋; line-height: 1.45;">通过重定向输出结果到一个特殊的</span><span style="font-size: 12pt; font-family: 华文仿宋;">叫做 “/dev/null” 的文件。这个文件是系统设备，叫做位存储桶，它可以接受输入，并且对输</span><span style="font-size: 12pt; font-family: 华文仿宋; line-height: 1.45;">入不做任何处理。为了隐瞒命令错误信息，我们这样做：</span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="font-size: 12pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; line-height: 1.45;">    ls -l /bin/usr 2&gt; /dev/null    </span></div></div><div><span style="font-size: 12pt;">5、重定向标准输入</span></div><blockquote style="margin: 0px 0px 0px 40px; border: none; padding: 0px;"><div><span style="font-size: 12pt; line-height: 1.45;">①、cat <span style="font-size: 12pt; line-height: 1.45;">－连接文件， <span style="font-size: 12pt; line-height: 1.45;">cat 命令读取一个或多个文件，然后复制它们到标准输出</span></span></span></div><div><span style="font-size: 12pt; line-height: 1.45;">    cat不跟任何文件参数，表示</span><span style="font-size: 12pt; line-height: 1.45;">它会从标准输入读入数据。<span style="font-size: 12pt;"><span style="font-size: 12pt; line-height: 1.45; color: rgb(227, 0, 0);">由于文件名参数的缺席，cat 复制标准输入到标准输出</span></span></span></div><blockquote style="margin: 0px 0px 0px 40px; border: none; padding: 0px;"><div><br/></div><div><img src="7、重定向_files/ScreenClip [2].png" type="image/png" data-filename="ScreenClip.png" style="font-size: 12pt; color: rgb(227, 0, 0);"/></div></blockquote></blockquote><div><blockquote style="margin: 0px 0px 0px 40px; border: none; padding: 0px;"><div>        <img src="7、重定向_files/ScreenClip [3].png" type="image/png" data-filename="ScreenClip.png" style="font-size: 9pt;"/></div></blockquote><div><br/></div></div><div><span style="font-size: 12pt;">6、管道线</span></div></div><div><span style="font-size: 12pt;">     </span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 9pt;">   comannd1 | comannd2</span></div></div><div><span style="font-size: 12pt; line-height: 1.45;">    “|” 一个命令的标准输出可以通过管道到另一个命令的标准输入</span></div><div><span style="font-size: 12pt;">    </span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 14pt;">  ls -l/usr/bin | less</span></div></div><div><span style="font-size: 12pt;">  </span></div><div><span style="font-size: 12pt;">    用less一页页的浏览任何命令的输出</span></div><div><span style="line-height: 18.4px;">7、过滤器</span></div><div><font style="font-size: 18px;"><span style="font-size: 18px; line-height: 18.4px;">    <span style="font-size: 12pt; line-height: 18.4px;">有可能会把几个命令放在一起组成一个管道线，</span></span></font><span style="font-size: 12pt; line-height: 1.45;">通常，以这种方式使用的命令被称为过滤器</span></div><div><br/></div><div><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div><img src="7、重定向_files/ScreenClip [4].png" type="image/png" data-filename="ScreenClip.png" style="font-size: 12pt;"/></div></blockquote></div><div><span style="font-size: 12pt;">8、</span><span style="font-size: 12pt;">uniq 报道或忽略重复行</span></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt;">       uniq -d    --repeat  打印重复行</span></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt;">       uniq   忽略重复行</span></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt;">9、wc  默认打印文件行、字和字节数</span></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt;">        wc  -l  只打印行数</span></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt;">10、grep -打印匹配行 （</span><span style="font-size: 12pt; color: rgb(227, 0, 0);">正则表达式</span><span style="font-size: 12pt;">）</span></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-family: 华文仿宋;">            grep 有－对方便的选项：“-i” 导致 grep 忽略大小写当执行搜索时（通常，搜索是大小写敏</span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-family: 华文仿宋;">    感的），“-v” 选项会告诉 grep 只打印不匹配的行。</span></span></div><div><br/></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt;">11、head、tail -打印文件开头部分、结尾部分</span></font></div><div><br/></div><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div><font style="font-size: 12pt;"><span style="font-size: 12pt;">        <img src="7、重定向_files/ScreenClip [5].png" type="image/png" data-filename="ScreenClip.png" style="font-size: 12pt;"/></span></font></div><div><br/></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-family: 华文仿宋;">        使用 “-f” 选项，tail 命令继续监测这个文件，当新的内容添加到文件后，它们会立即出现</span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-family: 华文仿宋;">在屏幕上。这会一直继续下去直到你输入 Ctrl-c。</span></span></div><div><br/></div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div><img src="7、重定向_files/ScreenClip [6].png" type="image/png" data-filename="ScreenClip.png" style="font-size: 12pt;"/></div><div><br/></div></blockquote><div><span style="line-height: 1.45; font-size: 12pt;">12、tee   -从stdin中读取数据，并且输出到stdout和文件</span></div><div><br/></div></blockquote><div><span style="line-height: 1.45;">    </span><span style="line-height: 1.45;">                <img src="7、重定向_files/ScreenClip [7].png" type="image/png" data-filename="ScreenClip.png" style="font-size: 9pt;"/></span></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt;">    </span></font></div></div><div><br/></div></span>
</div></body></html> 